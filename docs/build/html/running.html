

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running &mdash; MicroExonator  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Output" href="output.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MicroExonator
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quick_summary.html">Quick-Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="licence.html">MicroExonator Licence</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MicroExonator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Running</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/running.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running">
<span id="id1"></span><h1>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h1>
<p>We highly recommend creating a screen before running MicroExonator</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>screen -S session_name  <span class="c1">#choose a meaning full name to you</span>
</pre></div>
</div>
<p>To activate snakemake enviroment</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda activate snakemake_env
</pre></div>
</div>
<p>In case you already have an older version of conda use instead:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> activate snakemake_env
</pre></div>
</div>
<p>Then run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snakemake -s MicroExonator.skm  --cluster-config cluster.json --cluster <span class="o">{</span>cluster system params<span class="o">}</span> --use-conda -k  -j <span class="o">{</span>number of parallel jobs<span class="o">}</span>
</pre></div>
</div>
<p>Before running it is recommended to check if SnakeMake can corretly generate all the steps given your input. To do this you can carry out a dry-run using the -np parameter:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snakemake -s MicroExonator.skm  --cluster-config cluster.json --cluster <span class="o">{</span>cluster system params<span class="o">}</span> --use-conda -k  -j <span class="o">{</span>number of parallel jobs<span class="o">}</span> -np
</pre></div>
</div>
<p>The dry-run will display all the steps and commands that will be excecuted. If the dry-run cannot be initiated, make sure that you are running MicroExonator from inside the folder you cloned from this repository. Also make sure you have the right configuration inside config.yaml.</p>
<p>Notice that you should use –cluster only if you are working in a computer cluster that uses a queuing systems. We provide an example of cluster.json to work with lsf and in that case the cluster system params should be “bsub -n {cluster.nCPUs} -R {cluster.resources} -c {cluster.tCPU} -G {cluster.Group} -q {cluster.queue} -o {cluster.output} -e {cluster.error} -M {cluster.memory}”. The number of parallel jobs can be a positive integer, the appropriate value depends on the capacity of your machine but for most users a value between 5 and 50 is appropriate.</p>
<p>If you want to process a large dataset, we recommend to set Optimize_hard_drive as T. If you tho this, you can also run the pipeline in two steps:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snakemake -s MicroExonator.skm  --cluster-config cluster.json --cluster <span class="o">{</span>cluster system params<span class="o">}</span> --use-conda -k  -j <span class="o">{</span>number of parallel jobs<span class="o">}</span> discovery
</pre></div>
</div>
<p>If you do not have space to have a let MicroExonator to have a complete copy of the data you want to process, you can limmit the number of jobs. For instance if you limit the number of jobs to 20, you can make sure no more than 20 fastq files will be stored at <cite>FASTQ/</cite> directory (if <cite>Optimize_hard_drive</cite> is set as <cite>T</cite>)</p>
<p>If you are working remotelly, the connection is likely to die before MicroExonator finish. However, as long as you are working within an screen, loggin off will not kill snakemake. To list your active screens you can do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>screen -ls
</pre></div>
</div>
<p>To reattached and detach screens just use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>screen -r session_name  <span class="c1"># only detached screen can be reattached</span>

screen -d session_name
</pre></div>
</div>
<p><strong>Alternative splicing analyses</strong></p>
<p>Microexonator can couple the annotation and quantification of microexon with other downstream tools to asses alternative splicing changing. We have incorporated [whippet](<a class="reference external" href="https://github.com/timbitz/Whippet.jl">https://github.com/timbitz/Whippet.jl</a>) into a downstream snakemake workflow that can directly use the microexon annotation and quantification files to assess differential inclusion of microexons between multiple conditions. For this porpuse we recomend to install a custumised conda enviroment that has snkamemake and julia 0.6.1 installed. This can be don by using the following command from inside a MicroExonator folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="sb">`</span>conda env create -f Whippet/julia_0.6.1.yaml<span class="sb">`</span>
</pre></div>
</div>
<p>Where <cite>Whippet/julia_0.6.1.yam</cite> is yaml file with the recipe to create a stable environment with julia 0.6.1 and snakemake.</p>
<p>Then, activate the newly created enviroment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="sb">`</span><span class="nb">source</span> activate julia_0.6.1<span class="sb">`</span>
</pre></div>
</div>
<p>Enter julia’s interactive mode:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="sb">`</span>julia<span class="sb">`</span>
</pre></div>
</div>
<p>Install Whippet:</p>
<blockquote>
<div><p><cite>Pkg.add(“Whippet”)</cite></p>
</div></blockquote>
<p>Exit interactive julia session (<cite>control + d</cite>) and find Whippet’s binary folder, that should be inside of your miniconda environment folder. Once you find the path to this folder, add it to <cite>config.yaml</cite> writing the following lines:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>whippet_bin_folder : path/to/miniconda/envs/julia_0.6.1/share/julia/site/v0.6/Whippet/bin
Gene_anontation_GTF : path/to/gene_annotation.gtf
whippet_delta:
    Control_vs_TreatmentA :
        A : SRR309144,SRR309143,SRR309142,SRR309141
        B : SRR309136,SRR309135,SRR309134,SRR309133
    Control_vs_TreatmentB :
        A : SRR309140,SRR309139
        B : SRR309138,SRR309137
</pre></div>
</div>
<p>Where <cite>whippet_delta</cite> correspond to a dictionary that has all the comparions betweeen samples that you would like to do. Each comparison can have an arbitrary name (here as <cite>Control_vs_TreatmentA</cite> and <cite>Control_vs_TreatmentB</cite>). For each comparison two groups of samples are compared; <cite>A</cite> and <cite>B</cite>. These correspond to comma-separated list of the replicates for the conditions you are interested to compare.</p>
<p>Then we recomend to do a <cite>dry-run</cite> to check that all the inputs are in place:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snakemake -s MicroExonator.skm  --cluster-config cluster.json --cluster <span class="o">{</span>cluster system params<span class="o">}</span> --use-conda -k  -j <span class="o">{</span>number of parallel jobs<span class="o">}</span> differential_inclusion -np
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="output.html" class="btn btn-neutral float-right" title="Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral float-left" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Guillermo E. Parada

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>